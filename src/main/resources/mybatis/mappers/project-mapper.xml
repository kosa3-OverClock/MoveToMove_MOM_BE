<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kosa.kosafinalprojbackend.mybatis.mappers.project.ProjectMapper">

    <!-- 저장 -->
    <insert id="insertProject" parameterType="com.kosa.kosafinalprojbackend.domains.kanban.project.model.form.ProjectForm">
        INSERT
          INTO projects ( project_name
                        , project_description
                        , start_at
                        , end_at
                        )
                VALUES ( #{projectName}
                       , #{projectDescription}
                       , #{startAt}
                       , #{endAt}
                       )

        <!-- 방금 삽입된 row의 ID 가져오기 -->
      <selectKey keyProperty="projectId" resultType="long" order="AFTER">
        SELECT project_id
          FROM ( SELECT project_id
                   FROM projects
                  WHERE project_name = #{projectName}
               ORDER BY created_at DESC
                  LIMIT 1
               ) AS projectId
      </selectKey>
    </insert>

</mapper>